==	Деплой

Приложение разворачивается в OpenShift с использованием платформенной джобы sbbol-ufs.
Переданная сборка представляет собой архив с шаблонами конфигов OpenShift.

По результатам работы джобы в OpenShift создается 3 основных `Deployment`: `Ingress`, `Egress` и deployment с приложением.

К namespace должен быть подключен istio, так как проект использует конфигурации istio для управления трафиком внутри namespace.

В namespace создается 5 точек входа (`Route`):

* tls-роут, закрытый через SAN - используется только для HealthCheck, потребители отсутствуют
* tls-роут через геобалансировщик, закрытый через SAN - используется только для HealthCheck, потребители отсутствуют
* ott-роут, выполняющий валидацию токена OTT
* ott-роут через геобалансировщик, выполняющий валидацию токена OTT
* открытый health-check роут, по которому доступ разрешен только к контексту `/actuator/...`

Для проверки корректной установки можно выполнить следующие запросы:

* Вызов HealthCheck +

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/actuator/health -H "Content-Type: application/json" --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"status":"UP","components":{"dataSpaceCoreIndicator":{"status":"UP","details":{"DataSpaceCore":"Available"}},"diskSpace":{"status":"UP","details":{"total":107321753600,"free":78606151680,"threshold":10485760,"exists":true}},"livenessState":{"status":"UP"},"ping":{"status":"UP"},"readinessState":{"status":"UP"}},"groups":["liveness","readiness"]}
----

* Создание или обновление события в агрегаторе антифрод (РПП) (*вставляет и или обновляет данные в базе!*) +

.payment_saveorupdate.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "saveOrUpdateData",
  "id": 1,
  "params": {
    "dataparams": {
      "timeStamp": "2020-03-23T12:34:33",
      "orgGuid": "5899acd3-dba7-41d4-83e4-ea17525d0d39",
      "digitalId": "1111",
      "timeOfOccurrence": "2020-03-23T15:10:05",
      "document": {
        "id": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
        "number": 257,
        "date": "2020-03-23",
        "amount": 332484,
        "currency": "RUB",
        "executionSpeed": "FEW_HOURS",
        "otherAccBankType": "OTHER_BANK",
        "otherAccOwnershipType": "ME_TO_YOU",
        "transferMediumType": "WIRE",
        "destination": "Возврат денежных средств по заказу 123412-93",
        "payer": {
          "accountNumber": "40702810500112958634",
          "inn": "7704681547"
        },
        "receiver": {
          "balAccNumber": "45678667897655789978",
          "otherAccName": "ООО Рога и копыта",
          "otherBicCode": "040012002",
          "otherAccType": "BILLER",
          "inn": "5038956712"
        }
      },
      "signs": [
        "{\"httpAccept\": \"text/javascript, text/html, application/xml, text/xml, */*\", \"httpReferer\": \"http://localhost:8000/reference_application/Login.do\", \"httpAcceptChars\": \"ISO-8859-1,utf-8;q=0.7,*;q=0.7\", \"httpAcceptEncoding\": \"gzip, deflate\", \"httpAcceptLanguage\": \"en,en-us;q=0.5\", \"ipAddress\": \"78.245.9.87\", \"privateIpAddress\": \"172.16.0.0\", \"tbCode\": \"546738\", \"userAgent\": \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)\", \"devicePrint\": \"version%3D3%2E4%2E1%2E0%5F1%26pm%5Ffpua%3Dmozilla%2F4%2E0%20%28compatible%3B%20\", \"channelIndicator\": \"WEB\", \"userGuid\": \"7c7bd0c1-2504-468e-8410-b4d00522014f\", \"signTime\": \"2020-03-23T15:01:15\", \"signLogin\": \"novikova01\", \"signCryptoprofile\": \"Новикова Ольга Трофимовна\", \"signCryptoprofileType\": \"OneTimePassword\", \"signToken\": \"signToken\", \"signType\": \"Единственная подпись\", \"signImsi\": \"6176CB3B83F33108E0CBD9F411CAF608\", \"signCertId\": \"signCertId\", \"signPhone\": \"915 168-67-32\", \"signEmail\": \"no@glavbaza36.ru\", \"signChannel\": \"TOKEN\", \"signSource\": \"SMS\", \"clientDefinedChannelIndicator\": \"PPRB_BROWSER\"}",
        "{\"httpAccept\": \"text/javascript, text/html, application/xml, text/xml, */*\", \"httpReferer\": \"http://localhost:8000/reference_application/Login.do\", \"httpAcceptChars\": \"ISO-8859-1,utf-8;q=0.7,*;q=0.7\", \"httpAcceptEncoding\": \"gzip, deflate\", \"httpAcceptLanguage\": \"en,en-us;q=0.5\", \"ipAddress\": \"91.225.10.97\", \"privateIpAddress\": \"192.11.0.0\", \"tbCode\": \"546738\", \"userAgent\": \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)\", \"mobSdkData\": \"version%20nt%206%2E1%3B%20win64%3B%20x64%3B%20trident%2F4%2E0%3B%20%2Enet\", \"channelIndicator\": \"WEB\", \"userGuid\": \"7c7bd0c1-2504-468e-8410-b4d00522014f\", \"signTime\": \"2020-03-23T15:28:25\", \"signLogin\": \"ivanov05\", \"signCryptoprofile\": \"Иванов Иван Иванович\", \"signCryptoprofileType\": \"OneTimePassword\", \"signToken\": \"signToken\", \"signType\": \"Единственная подпись\", \"signImsi\": \"6176CB3B83F33108E0CBD9F411CAF608\", \"signCertId\": \"signCertId\", \"signPhone\": \"903 158-55-12\", \"signEmail\": \"iv@glavbaza36.ru\", \"signChannel\": \"TOKEN\", \"signSource\": \"SMS\", \"clientDefinedChannelIndicator\": \"PPRB_BROWSER\"}",
        "{\"httpAccept\": \"text/javascript, text/html, application/xml, text/xml, */*\", \"httpReferer\": \"http://localhost:8000/reference_application/Login.do\", \"httpAcceptChars\": \"ISO-8859-1,utf-8;q=0.7,*;q=0.7\", \"httpAcceptEncoding\": \"gzip, deflate\", \"httpAcceptLanguage\": \"en,en-us;q=0.5\", \"ipAddress\": \"75.241.3.77\", \"privateIpAddress\": \"168.12.0.0\", \"tbCode\": \"546738\", \"userAgent\": \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)\", \"devicePrint\": \"version%3D3%2E4%2E1%2E0%5F1%26pm%5Ffpua%3Dmozilla%2F4%2E0%20%28compatible%3B%20\", \"channelIndicator\": \"WEB\", \"userGuid\": \"7c7bd0c1-2504-468e-8410-b4d00522014f\", \"signTime\": \"2020-03-23T16:00:05\", \"signLogin\": \"petrov11\", \"signCryptoprofile\": \"Петров Петр Петрович\", \"signCryptoprofileType\": \"OneTimePassword\", \"signToken\": \"signToken\", \"signType\": \"Единственная подпись\", \"signImsi\": \"6176CB3B83F33108E0CBD9F411CAF608\", \"signCertId\": \"signCertId\", \"signPhone\": \"916 243-67-34\", \"signEmail\": \"pe@glavbaza36.ru\", \"signChannel\": \"TOKEN\", \"signSource\": \"SMS\", \"clientDefinedChannelIndicator\": \"PPRB_BROWSER\"}"
      ]
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/payment -d "@payment_saveorupdate.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"requestId":"daff093d-4de8-439b-96ba-6bd34cee227f"}}
----

* Вызов ФП ИС для анализа события (РПП) +

.paymentfeed_analyze.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "analyzeOperation",
  "id": 1,
  "params": {
    "analyzeparams": {
      "docId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/payment -d "@paymentfeed_analyze.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"transactionId": "c9ec0107588b433ea025fcf31443e88c", "actionCode": "ALLOW", "comment": "Короткий комментарий", "detailledComment": "Расширенный комментарий", "waitingTime": "Время ожидания в случае actionCode=REVIEW"}}
----

* Создание или обновление события в агрегаторе антифрод (РПП v3) (*вставляет и или обновляет данные в базе!*) +

.paymentv3_saveorupdate.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "saveOrUpdateData",
  "id": 1,
  "params": {
    "dataparams": {
      "messageHeader": {
        "timeStamp": "2023-05-03T17:03:25.911225+03:00",
        "requestType": "ANALYZE"
      },
      "identificationData": {
        "userName": "123454334312",
        "clientTransactionId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
        "orgName": "38",
        "userLoginName": "ivanov05",
        "dboOperation": "PAYMENT_DT_0401060"
      },
      "deviceRequest": {
        "httpAccept": "text/javascript, text/html, application/xml, text/xml, */*",
        "httpReferrer": "http://localhost:8000/reference_application/Login.do",
        "httpAcceptChars": "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
        "httpAcceptEncoding": "gzip, deflate",
        "httpAcceptLanguage": "en,en-us;q=0.5",
        "ipAddress": "78.245.9.87",
        "userAgent": "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)",
        "devicePrint": "version%3D3%2E4%2E1%2E0%5F1%26pm%5Ffpua%3Dmozilla%2F4%2E0%20%28compatible%3B%20",
        "mobSdkData": "version%20nt%206%2E1%3B%20win64%3B%20x64%3B%20trident%2F4%2E0%3B%20%2Enet"
      },
      "eventDataList": {
        "eventData": {
          "eventType": "PAYMENT",
          "clientDefinedEventType": "BROWSER_PAYDOCRU",
          "eventDescription": "Платежное поручение",
          "timeOfOccurrence": "2023-05-03T17:03:25.919692+03:00"
        },
        "transactionData": {
          "amount": {
            "amount": 525000,
            "currency": "RUB"
          },
          "myAccountData": {
            "accountNumber": "40702810500112958634"
          },
          "otherAccountData": {
            "accountName": "ООО Рога и копыта",
            "accountNumber": "45678667897655789978",
            "routingCode": "040012002",
            "otherAccountOwnershipType": "ME_TO_YOU",
            "otherAccountType": "BILLER",
            "transferMediumType": "WIRE"
          },
          "executionSpeed": "FEW_HOURS",
          "otherAccountBankType": "OTHER_BANK"
        },
        "clientDefinedAttributeList": {
          "fact": [
            {
              "name": "Личный кабинет",
              "value": "12245431453312232",
              "dataType": "STRING"
            },
            {
              "name": "ИНН отправителя",
              "value": "7704681547",
              "dataType": "STRING"
            },
            {
              "name": "Номер платежного документа",
              "value": "2311",
              "dataType": "STRING"
            },
            {
              "name": "Дата платежного документа",
              "value": "2023-05-03",
              "dataType": "STRING"
            },
            {
              "name": "Назначение платежа",
              "value": "Возврат денежных средств по заказу 123412-93",
              "dataType": "STRING"
            }
          ]
        }
      },
      "signs": [
        {
          "signNumber": 0,
          "sign": "{\"signTime\":\"2023-05-02T13:57:25.561427\",\"signIp\":\"172.16.0.0\",\"signLogin\":\"ivanov05\",\"signCryptoprofile\":\"Иванов Иван Иванович\",\"signCryptoprofileType\":\"OneTimePassword\",\"signToken\":\"token\",\"signType\":\"Единственная подпись\",\"signImsi\":\"6176CB3B83F33108E0CBD9F411CAF608\",\"signCertId\":\"certId\",\"signPhone\":\"903 158-55-12\",\"signEmail\":\"iv@glavbaza36.ru\",\"signChannel\":\"TOKEN\",\"signSource\":\"SMS\",\"signDigitalUserId\":\"signDigitalUserId\",\"signMacAddress\":\"signMacAddress\",\"signGeoLocation\":\"signGeoLocation\",\"signPkProperty\":\"signPkProperty\"}"
        },
        {
          "signNumber": 3,
          "sign": "{\"signTime\":\"2023-05-02T13:57:25.561427\",\"signIp\":\"172.16.0.0\",\"signLogin\":\"ivanov05\",\"signCryptoprofile\":\"Иванов Иван Иванович\",\"signCryptoprofileType\":\"OneTimePassword\",\"signToken\":\"token\",\"signType\":\"Единственная подпись\",\"signImsi\":\"6176CB3B83F33108E0CBD9F411CAF608\",\"signCertId\":\"certId\",\"signPhone\":\"903 158-55-12\",\"signEmail\":\"iv@glavbaza36.ru\",\"signChannel\":\"TOKEN\",\"signSource\":\"SMS\",\"signDigitalUserId\":\"signDigitalUserId\",\"signMacAddress\":\"signMacAddress\",\"signGeoLocation\":\"signGeoLocation\",\"signPkProperty\":\"signPkProperty\"}"
        }
      ],
      "channelIndicator": "WEB",
      "clientDefinedChannelIndicator": "PPRB_BROWSER"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v3/payment -d "@paymentv3_saveorupdate.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"requestId":"daff093d-4de8-439b-96ba-6bd34cee227f"}}
----

* Вызов ФП ИС для анализа события (РПП v3) +

.paymentfeed_analyze.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "analyzeOperation",
  "id": 1,
  "params": {
    "analyzeparams": {
      "docId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v3/payment -d "@paymentfeed_analyze.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"transactionId": "c9ec0107588b433ea025fcf31443e88c", "actionCode": "ALLOW", "comment": "Короткий комментарий", "detailledComment": "Расширенный комментарий", "waitingTime": "Время ожидания в случае actionCode=REVIEW"}}
----

* Создание или обновление события в агрегаторе антифрод (СБП) (*вставляет и или обновляет данные в базе!*) +

.fastpayment_saveorupdate.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "saveOrUpdateData",
  "id": 1,
  "params": {
    "dataparams": {
      "timeStamp": "2020-03-23T12:34:33",
      "orgGuid": "5899acd3-dba7-41d4-83e4-ea17525d0d38",
      "digitalId": "1111",
      "timeOfOccurrence": "2020-03-23T15:10:05",
      "document": {
        "id": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
        "number": 257,
        "date": "2020-03-23",
        "amount": 332484,
        "currency": "RUB",
        "idOperationOPKC": "idOperationOPKC",
        "destination": "Возврат денежных средств по заказу 123412-93",
        "payer": {
          "accountNumber": "40702810500112958634",
          "financialName": "financialName",
          "osbNum": "osbNum",
          "vspNum": "vspNum",
          "accBalance": "12400",
          "accCreateDate": "2020-03-23",
          "bic": "34567876",
          "documentNumber": "2736",
          "documentType": "documentType",
          "segment": "segment",
          "inn": "7704681547"
        },
        "receiver": {
          "otherAccName": "ООО Рога и копыта",
          "otherBicCode": "040012002",
          "inn": "5038956712",
          "bankName": "ПАО СБЕРБАНК",
          "bankCountryCode": "1000",
          "bankCorrAcc": "689805038956712",
          "bankId": "1347898",
          "document": "document",
          "documentType": "documentType",
          "phoneNumber": "792345468775",
          "account": "65654678967542718138"
        }
      },
      "signs": [
        "{\"httpAccept\": \"text/javascript, text/html, application/xml, text/xml, */*\", \"httpReferer\": \"http://localhost:8000/reference_application/Login.do\", \"httpAcceptChars\": \"ISO-8859-1,utf-8;q=0.7,*;q=0.7\", \"httpAcceptEncoding\": \"gzip, deflate\", \"httpAcceptLanguage\": \"en,en-us;q=0.5\", \"ipAddress\": \"78.245.9.87\", \"privateIpAddress\": \"172.16.0.0\", \"tbCode\": \"546738\", \"userAgent\": \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)\", \"devicePrint\": \"version%3D3%2E4%2E1%2E0%5F1%26pm%5Ffpua%3Dmozilla%2F4%2E0%20%28compatible%3B%20\", \"channelIndicator\": \"WEB\", \"userGuid\": \"7c7bd0c1-2504-468e-8410-b4d00522014f\", \"signTime\": \"2020-03-23T15:01:15\", \"signLogin\": \"novikova01\", \"signCryptoprofile\": \"Новикова Ольга Трофимовна\", \"signCryptoprofileType\": \"OneTimePassword\", \"signToken\": \"signToken\", \"signType\": \"Единственная подпись\", \"signImsi\": \"6176CB3B83F33108E0CBD9F411CAF608\", \"signCertId\": \"signCertId\", \"signPhone\": \"915 168-67-32\", \"signEmail\": \"no@glavbaza36.ru\", \"signChannel\": \"TOKEN\", \"signSource\": \"SMS\", \"clientDefinedChannelIndicator\": \"PPRB_BROWSER\"}",
        "{\"httpAccept\": \"text/javascript, text/html, application/xml, text/xml, */*\", \"httpReferer\": \"http://localhost:8000/reference_application/Login.do\", \"httpAcceptChars\": \"ISO-8859-1,utf-8;q=0.7,*;q=0.7\", \"httpAcceptEncoding\": \"gzip, deflate\", \"httpAcceptLanguage\": \"en,en-us;q=0.5\", \"ipAddress\": \"91.225.10.97\", \"privateIpAddress\": \"192.11.0.0\", \"tbCode\": \"546738\", \"userAgent\": \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)\", \"mobSdkData\": \"version%20nt%206%2E1%3B%20win64%3B%20x64%3B%20trident%2F4%2E0%3B%20%2Enet\", \"channelIndicator\": \"WEB\", \"userGuid\": \"7c7bd0c1-2504-468e-8410-b4d00522014f\", \"signTime\": \"2020-03-23T15:28:25\", \"signLogin\": \"ivanov05\", \"signCryptoprofile\": \"Иванов Иван Иванович\", \"signCryptoprofileType\": \"OneTimePassword\", \"signToken\": \"signToken\", \"signType\": \"Единственная подпись\", \"signImsi\": \"6176CB3B83F33108E0CBD9F411CAF608\", \"signCertId\": \"signCertId\", \"signPhone\": \"903 158-55-12\", \"signEmail\": \"iv@glavbaza36.ru\", \"signChannel\": \"TOKEN\", \"signSource\": \"SMS\", \"clientDefinedChannelIndicator\": \"PPRB_BROWSER\"}"
      ]
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/fastpayment -d "@fastpayment_saveorupdate.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"requestId":"daff093d-4de8-439b-96ba-6bd34cee227f"}}
----

* Вызов ФП ИС для анализа события (СБП) +

.fastpaymentfeed_analyze.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "analyzeOperation",
  "id": 1,
  "params": {
    "analyzeparams": {
      "docId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/fastpayment -d "@fastpaymentfeed_analyze.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"transactionId": "c9ec0107588b433ea025fcf31443e88c", "actionCode": "ALLOW", "comment": "Короткий комментарий", "detailledComment": "Расширенный комментарий", "waitingTime": "Время ожидания в случае actionCode=REVIEW"}}
----

* Создание или обновление события в агрегаторе антифрод (электронные чеки) (*вставляет и или обновляет данные в базе!*) +

.electronicreceipt_saveorupdate.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "saveOrUpdateData",
  "id": 1,
  "params": {
    "dataparams": {
      "orgGuid": "5899acd3-dba7-41d4-83e4-ea17525d0d38",
      "digitalId": "123456",
      "privateIpAddress": "10.41.111.111",
      "document": {
        "id": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
        "number": "0001",
        "date": "2020-03-23",
        "amount": 332484,
        "currency": "RUB",
        "destination": "Заявка на выдачу наличных денежных средств",
        "payer": {
          "tbCode": "038",
          "accountNumber": "40702810500112958634",
          "codeBic": "345678769",
          "name": "ООО Обнальщик",
          "inn": "7704681547",
          "kpp": "544378902"
        },
        "receiver": {
          "firstName": "Иван",
          "secondName": "Иванов",
          "middleName": "Иванович",
          "birthDay": "2001-01-01",
          "dulType": "21",
          "dulSerieNumber": "5038956712",
          "dulWhoIssue": "ГУ МВД России по г.Москве",
          "dulDateIssue": "2021-01-25",
          "dulCodeIssue": "503-712"
        },
        "receipt": {
          "receiptDate": "2021-08-08",
          "receiptTbCode": "038",
          "receiptOsbNumber": "9038",
          "receiptVspNumber": "01654",
          "receiptPlaceName": "Доп.офис №9038/01654",
          "receiptPlaceAddress": "г.Москва, Пресненская набережная, д.2"
        }
      },
      "deviceRequest": {
        "devicePrint": "version%3D3%2E4%2E1%2E0%5F1%26pm%5Ffpua%3Dmozilla%2F4%2E0%20%28compatible%3B%20",
        "httpAccept": "text/javascript, text/html, application/xml, text/xml, */*",
        "httpReferer": "http://localhost:8000/reference_application/Login.do",
        "httpAcceptChars": "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
        "httpAcceptEncoding": "gzip, deflate",
        "httpAcceptLanguage": "en,en-us;q=0.5",
        "ipAddress": "78.245.9.87",
        "userAgent": "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)"
      },
      "sign": {
        "signNumber": 1,
        "signIpAddress": "78.245.9.87",
        "signTime": "2020-03-23T15:01:15",
        "signLogin": "novikova01",
        "signCryptoprofile": "Новикова Ольга Трофимовна",
        "signCryptoprofileType": "OneTimePassword",
        "signType": "Единственная подпись",
        "signEmail": "no@glavbaza36.ru",
        "userGuid": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
        "signChannel": "TOKEN",
        "signToken": "TOKEN;IC0_T32S0000L_C1_VT505NT5;2017-08-10 13:41:33.000;TLS00786854C;23;1",
        "signCertId": "50CACB3B83F33108E0CBD9F411CAF608"
      }
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/electronicreceipt -d "@electronicreceipt_saveorupdate.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"requestId":"ba224c93-6f71-4ccc-9b33-ed1e7b338882"}}
----

* Вызов ФП ИС для анализа события (электронные чеки) +

.electronicreceipt_send.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "analyzeOperation",
  "id": 1,
  "params": {
    "analyzeparams": {
      "docId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/electronicreceipt -d "@electronicreceipt_send.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"transactionId": "c9ec0107588b433ea025fcf31443e88c", "actionCode": "ALLOW", "comment": "Короткий комментарий", "detailledComment": "Расширенный комментарий", "waitingTime": "Время ожидания в случае actionCode=REVIEW"}}
----

* Вызов ФП ИС для анализа события (партнеры) +

.counterparty_send.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "analyzeOperation",
  "id": 1,
  "params": {
    "analyzeparams": {
      "messageHeader": {
        "timeStamp": "2022-10-13T17:33:15.386",
        "requestType": "ANALYZE"
      },
      "identificationData": {
        "clientTransactionId": "5899acd3-dba7-41d4-83e4-ea17525d0d38",
        "orgName": "546738",
        "userName": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
        "dboOperation": "PARTNERS",
        "userLoginName": "user123"
      },
      "deviceRequest": {
        "devicePrint": "version%3D3%2E4%2E1%2E0%5F1%26pm%5Ffpua%3Dmozilla%2F4%2E0%20%28compatible%3B%20",
        "mobSdkData": null,
        "httpAccept": "text/javascript, text/html, application/xml, text/xml, */*",
        "httpAcceptChars": "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
        "httpAcceptEncoding": "gzip, deflate",
        "httpAcceptLanguage": "en,en-us;q=0.5",
        "httpReferrer": "http://localhost:8000/reference_application/Login.do",
        "ipAddress": "127.0.0.1",
        "userAgent": "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)"
      },
      "eventData": {
        "eventType": "ANY_TYPE",
        "eventDescription": "Счет доверенного контрагента",
        "clientDefinedEventType": "BROWSER_APPROVAL",
        "timeOfOccurrence": "2022-10-13T17:33:15.386"
      },
      "clientDefinedAttributeList": {
        "receiverName": "Наименование получателя",
        "counterpartyId": "861fec98-e72e-4d53-9603-39eae8322e8d",
        "userComment": "",
        "receiverInn": "765434657897654",
        "payerInn": "768878967564567",
        "receiverBicSwift": "34587",
        "receiverAccount": "96545792",
        "osbNumber": "23112",
        "vspNumber": "42523",
        "dboOperationName": "Занесение/подтверждение счета контрагента из справочника доверенных контрагентов",
        "payerName": "Наименование клиента",
        "firstSignTime": "2022-10-13T17:33:15.386",
        "firstSignIpAddress": "127.0.0.1",
        "firstSignLogin": "login123",
        "firstSignCryptoprofile": "Иванов Иван Иванович",
        "firstSignCryptoprofileType": "OneTimePassword",
        "firstSignChannel": "WEB",
        "firstSignToken": "token",
        "firstSignType": "Единственная подпись",
        "firstSignImsi": "6176CB3B83F33108E0CBD9F411CAF608",
        "firstSignCertId": "cert",
        "firstSignPhone": "+7 999 888-77-66",
        "firstSignEmail": "some@email.ru",
        "firstSignSource": "SMS",
        "senderIpAddress": "127.0.0.1",
        "senderLogin": "login123",
        "senderPhone": "+7 999 888-77-66",
        "senderEmail": "some@email.ru",
        "senderSource": "SMS",
        "privateIpAddress": "127.0.0.1",
        "epkId": "5ceba04c-18d0-4ff2-8244-1fd019ee41f2",
        "digitalId": "1232456",
        "sbbolGuid": "291674cf-d9cd-4fed-99e0-037828a42075",
        "reestrId": "87653456789",
        "reestrRowCount": "1000",
        "reestrRowNumber": "15"
      },
      "channelIndicator": "WEB",
      "clientDefinedChannelIndicator": "PPRB_BROWSER"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/counterparty -d "@counterparty_send.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"transactionId": "c9ec0107588b433ea025fcf31443e88c", "actionCode": "ALLOW", "comment": "Короткий комментарий", "detailledComment": "Расширенный комментарий", "waitingTime": "Время ожидания в случае actionCode=REVIEW"}}
----

* Вызов ФП ИС для анализа события (заявка на кредит или банковская гарантия) +

.credit_send.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "analyzeOperation",
  "id": 1,
  "params": {
    "analyzeparams": {
      "messageHeader": {
        "timeStamp": "2022-10-13T17:33:15.386",
        "requestType": "ANALYZE"
      },
      "identificationData": {
        "clientTransactionId": "5899acd3-dba7-41d4-83e4-ea17525d0d38",
        "tbCode": "546738",
        "userUcpId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
        "dboOperation": "CREDIT_REQ_MMB_PPRB",
        "userLoginName": "user123"
      },
      "deviceRequest": {
        "devicePrint": "version%3D3%2E4%2E1%2E0%5F1%26pm%5Ffpua%3Dmozilla%2F4%2E0%20%28compatible%3B%20",
        "mobSdkData": null,
        "httpAccept": "text/javascript, text/html, application/xml, text/xml, */*",
        "httpAcceptChars": "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
        "httpAcceptEncoding": "gzip, deflate",
        "httpAcceptLanguage": "en,en-us;q=0.5",
        "httpReferer": "http://localhost:8000/reference_application/Login.do",
        "ipAddress": "127.0.0.1",
        "userAgent": "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)"
      },
      "eventData": {
        "eventType": "ANY_TYPE",
        "eventDescription": "Счет доверенного контрагента",
        "clientDefinedEventType": "BROWSER_REQUEST_GUARANTEE",
        "timeOfOccurrence": "2022-10-13T17:33:15.386",
        "transactionData": {
          "amount": 5500000,
          "currency": "RUB"
        }
      },
      "clientDefinedAttributeList": {
        "requestNumber": "requestNumber",
        "createDate": "2022-10-13",
        "applicantShortName": "applicantShortName",
        "cardCurrency": "cardCurrency",
        "applicantTaxNumber": "applicantTaxNumber",
        "applicantKpp": "applicantKpp",
        "applicantKppList": "applicantKppList",
        "applicantOgrn": "applicantOgrn",
        "applicantFullName": "applicantFullName",
        "applicantFullNameInt": "applicantFullNameInt",
        "applicantShortNameInt": "applicantShortNameInt",
        "accountList": "accountList",
        "productName": "productName",
        "loanAmount": "loanAmount",
        "guaranteeAmount": "guaranteeAmount",
        "rate": "rate",
        "creditDuration": "creditDuration",
        "repaymentSchedule": "repaymentSchedule",
        "contactPhone": "contactPhone",
        "notificationPhone": "notificationPhone",
        "cardChannel": "cardChannel",
        "osbNumber": "osbNumber",
        "vspNumber": "vspNumber",
        "dboOperationName": "dboOperationName",
        "clientName": "clientName",
        "mainActivity": "mainActivity",
        "clientCategory": "clientCategory",
        "onlySignDateTime": "2022-10-13T17:33:15.386",
        "onlySignIpAddress": "onlySignIpAddress",
        "onlySignLogin": "onlySignLogin",
        "onlySignCryptoprofile": "onlySignCryptoprofile",
        "onlySignCryptoprofileType": "onlySignCryptoprofileType",
        "onlySignChannel": "onlySignChannel",
        "onlySignToken": "onlySignToken",
        "onlySignType": "onlySignType",
        "onlySignImsi": "onlySignImsi",
        "onlySignCertId": "onlySignCertId",
        "onlySignPhone": "onlySignPhone",
        "onlySignEmail": "onlySignEmail",
        "onlySignSource": "onlySignSource",
        "privateIpAddress": "privateIpAddress",
        "ucpId": "ucpId",
        "ucpIdDirector": "ucpIdDirector",
        "digitalId": "digitalId",
        "sbbolGuid": "sbbolGuid",
        "creationChannel": "creationChannel",
        "cfleId": "cfleId",
        "divisionCode": "divisionCode",
        "creditPurpose": "creditPurpose",
        "selectedParametersDescr": "selectedParametersDescr",
        "gracePeriod": "gracePeriod",
        "productPurposeSystemName": "productPurposeSystemName",
        "productPurposeName": "productPurposeName",
        "monthlyPayment": "monthlyPayment",
        "borrowerUcpId": "borrowerUcpId",
        "borrowerFio": "borrowerFio",
        "borrowerNumberDul": "borrowerNumberDul",
        "borrowerTypeDul": "borrowerTypeDul",
        "borrowerBirthday": "borrowerBirthday",
        "borrowerTaxNumber": "borrowerTaxNumber",
        "flIeUcpId": "flIeUcpId",
        "flIeFio": "flIeFio",
        "flIeNumberDul": "flIeNumberDul",
        "flIeIdTypeDul": "flIeIdTypeDul",
        "flIeBirthday": "flIeBirthday",
        "flIeTaxNumber": "flIeTaxNumber",
        "digitalUserId": "digitalUserId",
        "signMethod": "signMethod",
        "auctionNumber": "auctionNumber",
        "guaranteePurpose": "guaranteePurpose",
        "guaranteeType": "guaranteeType",
        "guaranteeForm": "guaranteeForm",
        "guaranteeCodeForm": "guaranteeCodeForm",
        "guaranteeDateStart": "guaranteeDateStart",
        "guaranteeDateEnd": "guaranteeDateEnd",
        "applicationsDateEnd": "applicationsDateEnd",
        "lawType": "lawType",
        "purchaseObjectName": "purchaseObjectName",
        "supplierMethodDeterm": "supplierMethodDeterm",
        "purchaseCode": "purchaseCode",
        "isUnreliable": "isUnreliable",
        "isArchived": "isArchived",
        "isMultipleLots": "isMultipleLots",
        "linkSiteGovProc": "linkSiteGovProc",
        "customerContractNumber": "customerContractNumber",
        "customerContractDate": "customerContractDate",
        "customerTaxNumber": "customerTaxNumber",
        "customerName": "customerName",
        "customerOgrn": "customerOgrn",
        "customerAddress": "customerAddress"
      },
      "channelIndicator": "WEB",
      "clientDefinedChannelIndicator": "PPRB_BROWSER"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/counterparty -d "@credit_send.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"transactionId": "c9ec0107588b433ea025fcf31443e88c", "actionCode": "ALLOW", "comment": "Короткий комментарий", "detailledComment": "Расширенный комментарий", "waitingTime": "Время ожидания в случае actionCode=REVIEW"}}
----

* Создание или обновление события в агрегаторе антифрод (универсальный API  ) (*вставляет и или обновляет данные в базе!*) +

.document_saveorupdate.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "saveOrUpdateData",
  "id": 1,
  "params": {
    "dataparams": {
      "timestamp": "2022-10-13T17:33:15.386+03:00",
      "requestType": "ANALYZE",
      "docId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
      "orgName": "orgName",
      "userName": "userName",
      "dboOperation": "dboOperation",
      "userLoginName": "userLoginName",
      "devicePrint": "devicePrint",
      "mobSdkData": "mobSdkData",
      "httpAccept": "httpAccept",
      "httpAcceptChars": "httpAcceptChars",
      "httpAcceptEncoding": "httpAcceptEncoding",
      "httpAcceptLanguage": "httpAcceptLanguage",
      "httpReferrer": "httpReferrer",
      "ipAddress": "ipAddress",
      "userAgent": "userAgent",
      "eventType": "eventType",
      "eventDescription": "eventDescription",
      "clientDefinedEventType": "clientDefinedEventType",
      "timeOfOccurrence": "2022-10-13T17:33:15.386+03:00",
      "amount": 4200000,
      "currency": "RUB",
      "executionSpeed": "executionSpeed",
      "otherAccountBankType": "otherAccountBankType",
      "myAccountNumber": "myAccountNumber",
      "accountName": "accountName",
      "otherAccountNumber": "otherAccountNumber",
      "routingCode": "routingCode",
      "otherAccountOwnershipType": "ownershipType",
      "otherAccountType": "otherAccountType",
      "transferMediumType": "transferMediumType",
      "clientDefinedAttributeList": [
        {
          "name": "ЕПК.id",
          "value": "2435423123142324312",
          "dataType": "STRING"
        },
        {
          "name": "Уникальный идентификатор пользователя",
          "value": "cda20b5e-11ff-43c6-abc3-f54c7c305058",
          "dataType": "STRING"
        },
        {
          "name": "ИНН отправителя",
          "value": "1324354653423123",
          "dataType": "STRING"
        },
        {
          "name": "ИНН получателя",
          "value": "1232453423142534",
          "dataType": "STRING"
        },
        {
          "name": "1-я подпись Время подписи",
          "value": "2022-10-13T17:33:15.386",
          "dataType": "STRING"
        }
      ],
      "customersDataList": [
        {
          "surname": "surname",
          "name": "name",
          "patronymic": "patronymic",
          "birthday": "2000-10-13",
          "passport_number": "passportNumber",
          "passport_series": "passportSeries",
          "mobile_phone": "mobilePhone",
          "status": "status"
        },
        {
          "surname": "surname",
          "name": "name",
          "patronymic": "patronymic",
          "birthday": "2000-10-13",
          "passport_number": "passportNumber",
          "passport_series": "passportSeries",
          "mobile_phone": "mobilePhone",
          "status": "status"
        }
      ],
      "channelIndicator": "WEB",
      "clientDefinedChannelIndicator": "PPRB_BROWSER"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/document/saveandsend -d "@document_saveorupdate.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{"jsonrpc":"2.0","id":1,"result":{"requestId":"ba224c93-6f71-4ccc-9b33-ed1e7b338882"}}
----

* Вызов ФП ИС для анализа события после сохранения (универсальный API) +

.document_send.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "analyzeOperation",
  "id": 1,
  "params": {
    "analyzeparams": {
      "docId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
      "dboOperation": "dboOperation"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/document/saveandsend -d "@document_send.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "identificationData": {
      "clientTransactionId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
      "delegated": false,
      "orgName": "orgName",
      "sessionId": "sessionId",
      "transactionId": "transactionId",
      "userLoginName": "userLoginName",
      "userName": "userName",
      "userStatus": "VERIFIED",
      "userType": "PERSISTENT"
    },
    "statusHeader": {
      "reasonCode": 0,
      "reasonDescription": "Operations were completed successfully",
      "statusCode": "200"
    },
    "riskResult": {
      "riskScore": 0,
      "riskScoreBand": "riskScoreBand",
      "triggeredRule": {
        "actionCode": "ALLOW",
        "actionName": "actionName",
        "actionType": "NONE",
        "ruleId": "ruleId",
        "ruleName": "ruleName",
        "comment": "comment",
        "detailledComment": "detailledComment",
        "waitingTime": 0
      }
    }
  }
}
----

* Вызов ФП ИС для анализа события без предварительного сохранения (универсальный API) +

.document_analyze.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "analyzeOperation",
  "id": 1,
  "params": {
    "analyzeparams": {
      "messageHeader": {
        "timeStamp": "2022-10-13T17:33:15.386",
        "requestType": "ANALYZE"
      },
      "identificationData": {
        "clientTransactionId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
        "orgName": "orgName",
        "userName": "userName",
        "dboOperation": "dboOperation",
        "userLoginName": "userLoginName"
      },
      "deviceRequest": {
        "devicePrint": "devicePrint",
        "mobSdkData": "mobSdkData",
        "httpAccept": "httpAccept",
        "httpAcceptChars": "httpAcceptChars",
        "httpAcceptEncoding": "httpAcceptEncoding",
        "httpAcceptLanguage": "httpAcceptLanguage",
        "httpReferrer": "httpReferrer",
        "ipAddress": "ipAddress",
        "userAgent": "userAgent"
      },
      "eventDataList": {
        "eventData": {
          "eventType": "eventType",
          "eventDescription": "eventDescription",
          "clientDefinedEventType": "clientDefinedEventType",
          "timeOfOccurrence": "2022-10-13T17:33:15.386"
        },
        "transactionData": {
          "amount": {
            "amount": 4200000,
            "currency": "RUB"
          },
          "executionSpeed": "executionSpeed",
          "otherAccountBankType": "otherAccountBankType",
          "myAccountData": {
            "accountNumber": "accountNumber"
          },
          "otherAccountData": {
            "accountName": "accountName",
            "accountNumber": "accountNumber",
            "routingCode": "routingCode",
            "otherAccountOwnershipType": "otherAccountOwnershipType",
            "otherAccountType": "otherAccountType",
            "transferMediumType": "transferMediumType"
          }
        },
        "customersDataList": {
          "customer": [
            {
              "surname": "surname",
              "name": "name",
              "patronymic": "patronymic",
              "birthday": "2000-10-13",
              "passport_number": "passportNumber",
              "passport_series": "passportSeries",
              "mobile_phone": "mobilePhone",
              "status": "status"
            },
            {
              "surname": "surname",
              "name": "name",
              "patronymic": "patronymic",
              "birthday": "2000-10-13",
              "passport_number": "passportNumber",
              "passport_series": "passportSeries",
              "mobile_phone": "mobilePhone",
              "status": "status"
            }
          ]
        },
        "clientDefinedAttributeList": {
          "fact": [
            {
              "name": "ЕПК.id",
              "value": "2435423123142324312",
              "dataType": "STRING"
            },
            {
              "name": "Уникальный идентификатор пользователя",
              "value": "cda20b5e-11ff-43c6-abc3-f54c7c305058",
              "dataType": "STRING"
            },
            {
              "name": "ИНН отправителя",
              "value": "1324354653423123",
              "dataType": "STRING"
            },
            {
              "name": "ИНН получателя",
              "value": "1232453423142534",
              "dataType": "STRING"
            },
            {
              "name": "1-я подпись Время подписи",
              "value": "2022-10-13T17:33:15.386",
              "dataType": "STRING"
            }
          ]
        }
      },
      "channelIndicator": "channelIndicator",
      "clientDefinedChannelIndicator": "clientDefinedChannelIndicator"
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/document/analyze -d "@document_analyze.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "identificationData": {
      "clientTransactionId": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
      "delegated": false,
      "orgName": "orgName",
      "sessionId": "sessionId",
      "transactionId": "transactionId",
      "userLoginName": "userLoginName",
      "userName": "userName",
      "userStatus": "VERIFIED",
      "userType": "PERSISTENT"
    },
    "statusHeader": {
      "reasonCode": 0,
      "reasonDescription": "Operations were completed successfully",
      "statusCode": "200"
    },
    "riskResult": {
      "riskScore": 0,
      "riskScoreBand": "riskScoreBand",
      "triggeredRule": {
        "actionCode": "ALLOW",
        "actionName": "actionName",
        "actionType": "NONE",
        "ruleId": "ruleId",
        "ruleName": "ruleName",
        "comment": "comment",
        "detailledComment": "detailledComment",
        "waitingTime": 0
      }
    }
  }
}
----

* Вызов ФП ИС для анализа события без предварительного сохранения (ИПТ) +

.ipt_analyze.json
[%collapsible]
====
[source,json]
----
{
  "jsonrpc": "2.0",
  "method": "analyzeOperation",
  "id": 1,
  "params": {
    "analyzeparams": {
      "messageHeader": {
        "timeStamp": "2022-10-13T17:33:15.386",
        "requestType": "ANALYZE"
      },
      "identificationData": {
        "clientTransactionId": "5899acd3-dba7-41d4-83e4-ea17525d0d38",
        "orgName": "orgName",
        "userName": "36ff1f5f-a0d2-4337-a4bd-1f620ac3462b",
        "dboOperation": "IPT",
        "userLoginName": "user123"
      },
      "deviceRequest": {
        "devicePrint": "version%3D3%2E4%2E1%2E0%5F1%26pm%5Ffpua%3Dmozilla%2F4%2E0%20%28compatible%3B%20",
        "mobSdkData": null,
        "httpAccept": "text/javascript, text/html, application/xml, text/xml, */*",
        "httpAcceptChars": "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
        "httpAcceptEncoding": "gzip, deflate",
        "httpAcceptLanguage": "en,en-us;q=0.5",
        "httpReferer": "http://localhost:8000/reference_application/Login.do",
        "ipAddress": "127.0.0.1",
        "userAgent": "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1; .NET CLR 2.0.50727)"
      },
      "eventData": {
        "eventType": "eventType",
        "eventDescription": "eventDescription",
        "clientDefinedEventType": "clientDefinedEventType",
        "timeOfOccurrence": "2022-10-13T17:33:15.386",
        "transactionData": {
          "amount": 5500000,
          "currency": "RUB",
          "myAccountData": {
            "accountNumber": "accountNumber"
          },
          "otherAccountData": {
            "accountName": "accountName",
            "accountNumber":"accountNumber",
            "routingCode": "routingCode"
          }
        }
      },
      "channelIndicator": "WEB",
      "clientDefinedChannelIndicator": "PPRB_BROWSER",
      "clientDefinedAttributeList": {
        "payerName": "payerName",
        "payerInn": "payerInn",
        "payerBic": "payerBic",
        "purpose": "purpose",
        "currencyName": "currencyName",
        "senderInn": "senderInn",
        "payeePhone": "payeePhone",
        "payeeKpp": "payeeKpp",
        "payeeAccountNumber": "payeeAccountNumber",
        "payeeMobilePhone": "payeeMobilePhone",
        "osbCode": "osbCode",
        "vspCode": "vspCode",
        "dboCode": "dboCode",
        "docNumber": "docNumber",
        "clientName": "clientName",
        "payeeBankBic": "payeeBankBic",
        "payeeBankNameCity": "payeeBankNameCity",
        "payerCorrBankName": "payerCorrBankName",
        "payeeAccountNumberList": "payeeAccountNumberList",
        "payeeBic": "payeeBic",
        "payerBankName": "payerBankName",
        "payerBankCorrAcc": "payerBankCorrAcc",
        "tbCode": "tbCode",
        "epkId": "epkId",
        "digitalId": "digitalId",
        "curOrgId": "curOrgId",
        "amount": "amount",
        "docDate": "docDate",
        "currencyIsoCode": "currencyIsoCode",
        "vatAmount": "vatAmount",
        "vatType": "vatType",
        "vatValue": "vatValue",
        "payeeBankCity": "payeeBankCity",
        "payerKpp": "payerKpp",
        "payeeBankCorrAcc": "payeeBankCorrAcc",
        "payeeName": "payeeName",
        "payeeInn": "payeeInn",
        "channel": "channel",
        "digitalUserId": "digitalUserId",
        "docGuid": "docGuid",
        "firstSignIp": "firstSignIp",
        "firstSignChannel": "firstSignChannel",
        "firstSignTime": "2022-10-13T17:33:15.386",
        "firstSignCryptoprofile": "firstSignCryptoprofile",
        "firstSignCryptoprofileType": "firstSignCryptoprofileType",
        "firstSignToken": "firstSignToken",
        "firstSignType": "firstSignType",
        "firstSignImsi": "firstSignImsi",
        "firstSignCertId": "firstSignCertId",
        "firstSignPhone": "firstSignPhone",
        "firstSignEmail": "firstSignEmail",
        "firstSignDigitalUserId": "firstSignDigitalUserId",
        "firstSignLogin": "firstSignLogin",
        "secondSignIp": "secondSignIp",
        "secondSignChannel": "secondSignChannel",
        "secondSignTime": "2022-10-13T17:33:15.386",
        "secondSignCryptoprofile": "secondSignCryptoprofile",
        "secondSignCryptoprofileType": "secondSignCryptoprofileType",
        "secondSignToken": "secondSignToken",
        "secondSignType": "secondSignType",
        "secondSignImsi": "secondSignImsi",
        "secondSignCertId": "secondSignCertId",
        "secondSignPhone": "secondSignPhone",
        "secondSignEmail": "secondSignEmail",
        "secondSignDigitalUserId": "secondSignDigitalUserId",
        "secondSignLogin": "secondSignLogin",
        "thirdSignIp": "thirdSignIp",
        "thirdSignChannel": "thirdSignChannel",
        "thirdSignTime": "2022-10-13T17:33:15.386",
        "thirdSignCryptoprofile": "thirdSignCryptoprofile",
        "thirdSignCryptoprofileType": "thirdSignCryptoprofileType",
        "thirdSignToken": "thirdSignToken",
        "thirdSignType": "thirdSignType",
        "thirdSignImsi": "thirdSignImsi",
        "thirdSignCertId": "thirdSignCertId",
        "thirdSignPhone": "thirdSignPhone",
        "thirdSignEmail": "thirdSignEmail",
        "thirdSignDigitalUserId": "thirdSignDigitalUserId",
        "thirdSignLogin": "thirdSignLogin",
        "singleSignIp": "singleSignIp",
        "singleSignChannel": "singleSignChannel",
        "singleSignTime": "2022-10-13T17:33:15.386",
        "singleSignCryptoprofile": "singleSignCryptoprofile",
        "singleSignCryptoprofileType": "singleSignCryptoprofileType",
        "singleSignToken": "singleSignToken",
        "singleSignType": "singleSignType",
        "singleSignImsi": "singleSignImsi",
        "singleSignCertId": "singleSignCertId",
        "singleSignPhone": "singleSignPhone",
        "singleSignEmail": "singleSignEmail",
        "singleSignDigitalUserId": "singleSignDigitalUserId",
        "singleSignLogin": "singleSignLogin"
      }
    }
  }
}
----
====

[source,bash]
----
curl -v https://ingress-ci03045533-sbbol-antifraud-tls.apps.dev-gen2.sigma.sbrf.ru/antifraud/v2/ipt -d "@ipt_analyze.json" -H "Content-Type: application/json" -X POST --cacert chain.pem --cert cert.pem --key cert.key
----

Пример ответа:
[source,json]
----
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "transactionId": "c9ec0107588b433ea025fcf31443e88c",
    "actionCode": "ALLOW",
    "comment": "Короткий комментарий",
    "detailledComment": "Расширенный комментарий",
    "waitingTime": "Время ожидания в случае actionCode=REVIEW",
    "statusCode": "200 OK",
    "reasonCode": 0
  }
}
----
